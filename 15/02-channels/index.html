
<!doctype html>
<html lang="tr" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Mustafa Akgül Özgür Yazılım Yaz Kampı 2023’te verilen Go Kursu">
      
      
        <meta name="author" content="Uğur vigo Özyılmazel">
      
      
        <link rel="canonical" href="https://vbyazilim.github.io/maoyyk2023-golang-101-kursu/15/02-channels/">
      
      
        <link rel="prev" href="../01-concurrency/">
      
      
        <link rel="next" href="../03-mutex/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.5.2, mkdocs-material-9.2.8">
    
    
      
        <title>Channels - MAÖYYK 2023 - Go Kursu</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.046329b4.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#bolum-1502-concurrency" class="md-skip">
          Ana içeriğe geç
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Başlık">
    <a href="../.." title="MAÖYYK 2023 - Go Kursu" class="md-header__button md-logo" aria-label="MAÖYYK 2023 - Go Kursu" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            MAÖYYK 2023 - Go Kursu
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Channels
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Ara" placeholder="Ara" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Ara">
        
        <button type="reset" class="md-search__icon md-icon" title="Temizle" aria-label="Temizle" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Arama başlatılıyor
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/vbyazilim/maoyyk2023-golang-101-kursu" title="Depoya git" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    vbyazilim/maoyyk2023-golang-101-kursu
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



  

<nav class="md-nav md-nav--primary md-nav--integrated" aria-label="Navigasyon" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="MAÖYYK 2023 - Go Kursu" class="md-nav__button md-logo" aria-label="MAÖYYK 2023 - Go Kursu" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    MAÖYYK 2023 - Go Kursu
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/vbyazilim/maoyyk2023-golang-101-kursu" title="Depoya git" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    vbyazilim/maoyyk2023-golang-101-kursu
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    İçindekiler
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Bölüm 01: Golang Hakkında Genel Bilgiler
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Bölüm 01: Golang Hakkında Genel Bilgiler
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../01/01-tanitim/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Tanıtım, Öne Çıkan Kısımları
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../01/02-proverbs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Go Proverbs
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../01/03-kurulum/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Kurulum
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../01/04-vscode-kurulumu/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    VSCode Kurulumu
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
      
        
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Bölüm 02: Golang Uygulamasına Genel Bakış
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Bölüm 02: Golang Uygulamasına Genel Bakış
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../02/01-paket-kavrami/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Paket Kavramı ve `main` Paketi
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../02/02-executable-lib-run/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Executable, Library ve Golang Uygulamasını Çalıştırmak
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Bölüm 03
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Bölüm 03
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../03/01-dil-kurallari/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Dil Kuralları
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../03/02-sabitler/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Sabitler
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../03/03-degiskenler/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Değişkenler
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Bölüm 04: Veri Tipleri
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Bölüm 04: Veri Tipleri
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../04/01-string/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Strings (metinseller)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../04/02-bool/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Booleans (mantıksallar)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../04/03-numerics/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Numerics (sayısallar)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../04/04-collections/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Koleksiyonlar
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../04/05-struct/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Structs (yapılar)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../04/05-struct-annotations/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Struct Annotations
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../04/06-pointer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Pointer (işaretçi) Kavramı
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../04/07-struct-methods-receivers/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Struct Methods ve Receivers
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../04/08-map/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Maps
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../04/09-tip-donusturmek/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Tip Dönüştürmek
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../../05/01-fonksiyonlar/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Bölüm 05: Fonksiyonlar
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Bölüm 06: Durum Kontrolleri
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            Bölüm 06: Durum Kontrolleri
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../06/01-durum-koontrolleri-if/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    if, else, else if
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../06/02-durum-koontrolleri-switch/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    switch/case
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../06/03-label-break-goto/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    label/break/goto
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../../07/01-dongu/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Bölüm 07: Döngüler
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../../08/01-interface/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Bölüm 08: Interface
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../../09/01-error/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Bölüm 09: Error
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../../10/01-nil/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Bölüm 10: nil
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../../11/01-generics/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Bölüm 11: Generics
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../../12/01-reflection/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Bölüm 12: Reflection
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../../13/01-json-ile-calismak/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Bölüm 13: JSON İle Çalışmak
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_15" >
        
          <label class="md-nav__link" for="__nav_15" id="__nav_15_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Bölüm 14: Test
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_15_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_15">
            <span class="md-nav__icon md-icon"></span>
            Bölüm 14: Test
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../14/01-test/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Test
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../14/02-table-driven-test/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Table Driven Test
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../14/03-test-coverage/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Test Coverage
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../14/04-profiling/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Profiling
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_16" checked>
        
          <label class="md-nav__link" for="__nav_16" id="__nav_16_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Bölüm 15: Concurrency
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_16_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_16">
            <span class="md-nav__icon md-icon"></span>
            Bölüm 15: Concurrency
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../01-concurrency/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Concurrency
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Channels
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Channels
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="İçindekiler">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      İçindekiler
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#channels" class="md-nav__link">
    Channels
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#unbuffered-channels" class="md-nav__link">
    Unbuffered Channels
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#done-pattern" class="md-nav__link">
    done Pattern
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#deadlock" class="md-nav__link">
    Deadlock
  </a>
  
    <nav class="md-nav" aria-label="Deadlock">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#unutmayin-altin-kural" class="md-nav__link">
    UNUTMAYIN! ALTIN KURAL
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#range-over-channels" class="md-nav__link">
    Range Over Channels
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#buffered-channels" class="md-nav__link">
    Buffered Channels
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#semaphore-pattern" class="md-nav__link">
    Semaphore Pattern
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#fan-out-pattern" class="md-nav__link">
    Fan Out Pattern
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#select" class="md-nav__link">
    select
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ticker" class="md-nav__link">
    Ticker
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#worker-pattern" class="md-nav__link">
    Worker Pattern
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nil-channel" class="md-nav__link">
    nil Channel
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#channela-nil-gondermek" class="md-nav__link">
    Channel’a nil Göndermek
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#drop-pattern" class="md-nav__link">
    Drop Pattern
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#kaynaklar" class="md-nav__link">
    Kaynaklar
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../03-mutex/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Mutex
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../04-context/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Context
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../../16/01-naming-conventions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Bölüm 16: İsimlendirme Kuralları
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_18" >
        
          <label class="md-nav__link" for="__nav_18" id="__nav_18_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Bölüm 17: Golang Paketi Geliştirmek
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_18_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_18">
            <span class="md-nav__icon md-icon"></span>
            Bölüm 17: Golang Paketi Geliştirmek
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../17/01-kurulumlar/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    golangci-linter
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../17/02-go-modul-anotomisi/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Go Modülü Anatomisi
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../17/03-ornek-paket/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    stringutils Paketi
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../17/04-paketi-dagitmak/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Paketi Dağıtmak
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_19" >
        
          <label class="md-nav__link" for="__nav_19" id="__nav_19_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Bölüm 18: In-Memory Key-Value Store
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_19_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_19">
            <span class="md-nav__icon md-icon"></span>
            Bölüm 18: In-Memory Key-Value Store
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../18/01-http-paketi/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    http Paketini Kullanarak Rest-API Tasarlamak
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../18/02-ddd-basics/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Domain Driven Design prensibini Kullanmak
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../18/03-development/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Geliştirme
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../18/04-testing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    http server’ın Unit Testleri
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../18/05-docker/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Uygulamanın Docker Container’ından Çalıştırılması
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../18/06-github-actions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    GitHub Actions
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../18/07-acik-kaynak/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Açık Kaynak
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
      
        
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_20" >
        
          <label class="md-nav__link" for="__nav_20" id="__nav_20_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Bonus
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_20_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_20">
            <span class="md-nav__icon md-icon"></span>
            Bonus
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../bonus/01-links/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Linkler
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="https://github.com/vbyazilim/kvstore" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    kvstore
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_21" >
        
          <label class="md-nav__link" for="__nav_21" id="__nav_21_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Quiz
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_21_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_21">
            <span class="md-nav__icon md-icon"></span>
            Quiz
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../quiz/01-go-cash-register/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Quiz 1
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="bolum-1502-concurrency">Bölüm 15/02: Concurrency</h1>
<h2 id="channels">Channels</h2>
<p><code>chan</code> (channel) go’da goroutine’ler arasında veri taşımaya yarayan ön-tanımlı
(built-in) bir tiptir. Yani <code>int</code> gibi <code>map</code> gibi bir tiptir. Bir goroutine
channel’a veri yazarken, başka bir goroutine o channel’ı dinleyip okuyabilir.</p>
<p>Asıl amaç channel’ların goroutine’ler arasında paylaşılabilmesidir. Hatta
sevgili Rob Pike’ın o efsane sözlerinden biri olan;</p>
<blockquote>
<p>Don't communicate by sharing memory, share memory by communicating</p>
</blockquote>
<p>hatırlatmak isterim; <strong>hafızayı paylaşarak</strong> iletişim kurmayın, 
<strong>iletişim kurarak</strong> hafızayı paylaşın! Yani channel’ları kullanın! diyor...</p>
<p>Normal şartlarda fonksiyon geriye değer dönebilir ama <code>go</code> anahtar kelimesiyle
tetiklenen fonksiyonların dönüşünü <code>main</code> beklemediği için, goroutine ile
çalışan fonksiyon ile <code>main</code> arasındaki iletişim channel’lar üzerinden
sağlanır.</p>
<ul>
<li>Birden fazla goroutine aynı channel’a yazabilir</li>
<li>Birden fazla goroutine aynı channel’dan okuyabilir</li>
</ul>
<p>Tabi tüm bunlar sizin uygulamak istediğiniz concurrency pattern’ine bağlı
olarak değişen şeylerdir.</p>
<ul>
<li>Channel’daki veri mutlaka bir tipte olmalı, yani <code>make(chan)</code> ile channel
  oluşturulmalı, aynı <code>map</code>’deki gibi...</li>
<li>Default olarak channel read/write (okuma/yazma) senkron işlemlerdir</li>
<li>Channel’a bir değer atamak, aynı fonksiyona parametre geçmek gibidir</li>
<li>Channel’a reference types (pointer, map, slice vs...) geçerken dikkatli olmak
  gerekir. Çünkü DATA RACE olması yüksek ihtimaldir. Yani bir goroutine değer okurken,
  diğer bir goroutine’de yeni değer atamaya çalışırsa durum race-condition durumu olur.</li>
</ul>
<p>Bir goroutine, channel’a yazdığı zaman, diğer bir goroutine o channel’dan
okuyana kadar pause / block olur. Yani goroutine channel’dan okumak istedi ve
okuyacağı bir değer (value) yoksa, değer gelene kadar o goroutine beklemeye
devam eder...</p>
<p>Aslında bu aynı linux/unix pipe’lara benzer:</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>cat<span class="w"> </span>foo<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span><span class="s1">&#39;bar&#39;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>cut<span class="w"> </span>-d<span class="s1">&#39;.&#39;</span><span class="w"> </span>-F1
<span class="c1">#               |           |</span>
<span class="c1">#               ↓           |</span>
<span class="c1">#          cat’i bekler     |      </span>
<span class="c1">#                           ↓</span>
<span class="c1">#                         grep’i bekler </span>
</code></pre></div>
<p>Channel’ı kapatmak, sizin artık o channel ile işinizin kalmadığı anlamına
gelir.</p>
<p>4 Tür channel var;</p>
<ol>
<li>Unbuffered</li>
<li>Buffered</li>
<li>Closed</li>
<li>Nil</li>
</ol>
<p>3 Tür channel state var;</p>
<ol>
<li><strong>nil</strong> -&gt; zero-value</li>
<li><strong>open</strong> -&gt; <code>make(...)</code></li>
<li><strong>close</strong> -&gt; <code>close(...)</code></li>
</ol>
<p><strong>State’ine göre send/receive uygunluğu</strong></p>
<table>
<thead>
<tr>
<th style="text-align: left;"></th>
<th style="text-align: left;">example</th>
<th style="text-align: left;">nil</th>
<th style="text-align: left;">open</th>
<th style="text-align: left;">closed</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">send</td>
<td style="text-align: left;"><code>ch &lt;- true</code></td>
<td style="text-align: left;">blocked</td>
<td style="text-align: left;">allowed</td>
<td style="text-align: left;">panic!</td>
</tr>
<tr>
<td style="text-align: left;">receive</td>
<td style="text-align: left;"><code>&lt;-ch</code></td>
<td style="text-align: left;">blocked</td>
<td style="text-align: left;">allowed</td>
<td style="text-align: left;">allowed</td>
</tr>
</tbody>
</table>
<p><strong>Garantileme durumuna göre</strong></p>
<table>
<thead>
<tr>
<th style="text-align: left;"></th>
<th style="text-align: left;">Garanti</th>
<th style="text-align: left;">Garanti Yok</th>
<th style="text-align: left;">Gecikmeli Garanti</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;"><code>channel</code></td>
<td style="text-align: left;">Unbuffered</td>
<td style="text-align: left;">Buffered <code>ch &gt; 1</code></td>
<td style="text-align: left;">Buffered <code>ch = 1</code></td>
</tr>
</tbody>
</table>
<p>Normalde channel’ı fonksiyona geçerken <strong>bi-directional</strong> yani hem <strong>send</strong>
hem de <strong>receive</strong> edebilir şekilde geçiyoruz;</p>
<div class="highlight"><pre><span></span><code><span class="kd">func</span><span class="w"> </span><span class="nx">Foo</span><span class="p">(</span><span class="nx">ch</span><span class="w"> </span><span class="kd">chan</span><span class="w"> </span><span class="kt">int</span><span class="p">){}</span>
</code></pre></div>
<p>Bunu limitlemek mümkün. Yani duruma göre <strong>receive-only</strong> ya da <strong>send-only</strong>
yapmak da mümkün;</p>
<div class="highlight"><pre><span></span><code><span class="kd">func</span><span class="w"> </span><span class="nx">receiveOnly</span><span class="p">(</span><span class="nx">ch</span><span class="w"> </span><span class="o">&lt;-</span><span class="kd">chan</span><span class="w"> </span><span class="kt">int</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">fmt</span><span class="p">.</span><span class="nx">Println</span><span class="p">(</span><span class="s">&quot;read/receive&quot;</span><span class="p">,</span><span class="w"> </span><span class="o">&lt;-</span><span class="nx">ch</span><span class="p">)</span>
<span class="p">}</span>

<span class="kd">func</span><span class="w"> </span><span class="nx">sendOnly</span><span class="p">(</span><span class="nx">ch</span><span class="w"> </span><span class="kd">chan</span><span class="o">&lt;-</span><span class="w"> </span><span class="kt">int</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">ch</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="mi">1</span>
<span class="p">}</span>
</code></pre></div>
<p><a href="https://github.com/vbyazilim/maoyyk2023-golang-101-kursu/tree/main/src/15/channels/send-only">Örnek</a></p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>go<span class="w"> </span>run<span class="w"> </span>src/15/channels/send-only/main.go
</code></pre></div>
<p>kod:</p>
<div class="highlight"><pre><span></span><code><span class="kn">package</span><span class="w"> </span><span class="nx">main</span>

<span class="kn">import</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="s">&quot;fmt&quot;</span>
<span class="p">)</span>

<span class="kd">func</span><span class="w"> </span><span class="nx">returnReceiveOnly</span><span class="p">()</span><span class="w"> </span><span class="o">&lt;-</span><span class="kd">chan</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">c</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nb">make</span><span class="p">(</span><span class="kd">chan</span><span class="w"> </span><span class="kt">int</span><span class="p">)</span>

<span class="w">    </span><span class="k">go</span><span class="w"> </span><span class="kd">func</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">defer</span><span class="w"> </span><span class="nb">close</span><span class="p">(</span><span class="nx">c</span><span class="p">)</span>

<span class="w">        </span><span class="c1">// bu fonksiyondan dönen channel&#39;ı receive</span>
<span class="w">        </span><span class="c1">// eden her kimse, en fazla 100 tane sayı</span>
<span class="w">        </span><span class="c1">// receive edebilir.</span>

<span class="w">        </span><span class="c1">// loop bitiminde defer ile channel kapandığı</span>
<span class="w">        </span><span class="c1">// için, 100+ zero-value =&gt; 0 gelir...</span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="p">&lt;</span><span class="w"> </span><span class="mi">100</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="o">++</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nx">c</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nx">i</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}()</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">c</span>
<span class="p">}</span>

<span class="kd">func</span><span class="w"> </span><span class="nx">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">r</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">returnReceiveOnly</span><span class="p">()</span><span class="w"> </span><span class="c1">// returns receive-only channel</span>

<span class="w">    </span><span class="c1">// r &lt;- 10 // invalid operation: cannot send to receive-only type &lt;-chan int</span>

<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="p">&lt;</span><span class="w"> </span><span class="mi">200</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="o">++</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">fmt</span><span class="p">.</span><span class="nx">Println</span><span class="p">(</span><span class="o">&lt;-</span><span class="nx">r</span><span class="p">)</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="c1">// read/write-only channels are distinct types, the compiler can use its existing</span>
<span class="c1">// type-checking mechanisms to ensure the caller does not try to write stuff</span>
<span class="c1">// into a channel it has no business writing to.</span>
</code></pre></div>
<p>Bi-directional channel ile teknik/performans farkı yok sadece compile-time’da;
<strong>receive only</strong> kullanmak istediğiniz channel’a send etmek isterseniz;</p>
<div class="highlight"><pre><span></span><code>invalid<span class="w"> </span>operation:<span class="w"> </span>cannot<span class="w"> </span>send<span class="w"> </span>to<span class="w"> </span>receive-only<span class="w"> </span><span class="nb">type</span><span class="w"> </span>&lt;-chan<span class="w"> </span>int
</code></pre></div>
<p>gibi hata vererek kodu düzeltmenizi ister. Şimdi ilk yaptığımız, hani
<code>time.Sleep</code> kullanarak yaptığımız örneği <strong>channel</strong> kullanarak yapalım;</p>
<p><a href="https://github.com/vbyazilim/maoyyk2023-golang-101-kursu/tree/main/src/15/channels/basic-goroutine-with-channel">Örnek</a></p>
<p><a href="https://go.dev/play/p/E8EzcHasNxE">https://go.dev/play/p/E8EzcHasNxE</a></p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>go<span class="w"> </span>run<span class="w"> </span>src/15/channels/basic-goroutine-with-channel/main.go
</code></pre></div>
<p>kod:</p>
<div class="highlight"><pre><span></span><code><span class="kn">package</span><span class="w"> </span><span class="nx">main</span>

<span class="kn">import</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="s">&quot;fmt&quot;</span>
<span class="p">)</span>

<span class="kd">func</span><span class="w"> </span><span class="nx">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">ch</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nb">make</span><span class="p">(</span><span class="kd">chan</span><span class="w"> </span><span class="kt">bool</span><span class="p">)</span><span class="w"> </span><span class="c1">// channel holds bool type!</span>

<span class="w">    </span><span class="k">go</span><span class="w"> </span><span class="kd">func</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">fmt</span><span class="p">.</span><span class="nx">Println</span><span class="p">(</span><span class="s">&quot;hello from goroutine!&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="nx">ch</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="kc">true</span><span class="w"> </span><span class="c1">// writing to ch channel</span>
<span class="w">    </span><span class="p">}()</span>

<span class="w">    </span><span class="o">&lt;-</span><span class="nx">ch</span><span class="w"> </span><span class="c1">// channel&#39;dan veri gelene kadar blok!, reading from ch channel</span>
<span class="w">    </span><span class="nx">fmt</span><span class="p">.</span><span class="nx">Println</span><span class="p">(</span><span class="s">&quot;exit!&quot;</span><span class="p">)</span>
<span class="p">}</span>

<span class="c1">// hello from goroutine!</span>
<span class="c1">// exit!</span>
</code></pre></div>
<p><img alt="Goroutine With Channel" src="../diagrams/goroutine-with-channel.gif" /></p>
<hr />
<h2 id="unbuffered-channels">Unbuffered Channels</h2>
<p>Aslında şu ana kadar yaptığımız örnekler unbuffered channels örnekleriydi.
Yani channel, tampon olmaksızın, ayni unix/linux’daki pipe mantığıyla
al-gülüm-ver-gülüm şeklinde <strong>senkron</strong> şekilde çalıştı. Yani alma-verme işi
senkron, aynı anda oldu. Bu kesin garantili bir yöntem.</p>
<p>Channel’a gönderme (send) ve channel’dan okuma (receive) aynı anda oldu. Yani
almak için birinin göndermesi lazım. Aksi halde <strong>blocking</strong> işlem oluyor. Bu
durum <strong>unknown latency</strong> yani bilinmeyen bir gecikmeye sebep olur.</p>
<p>Şöyle düşünün; <code>curl &lt;URL&gt; | grep 'foo'</code> eğer indirmek istediğiniz dosya çok
büyükse, (gigabyte’lar seviyesi) <code>grep</code> <code>curl</code>’ü download hızınız kadar
beklemek zorunda.</p>
<p>Garanti şu anlamdadır: receive (yani channel’dan alma), send’den (yani
channel’a gönderme) nano saniye kadar önce olur.</p>
<p><a href="https://www.youtube.com/watch?v=LvgVSSpwND8">https://www.youtube.com/watch?v=LvgVSSpwND8</a></p>
<h2 id="done-pattern"><code>done</code> Pattern</h2>
<p><a href="https://github.com/vbyazilim/maoyyk2023-golang-101-kursu/tree/main/src/15/channels/done-pattern">Örnek</a></p>
<p><a href="https://go.dev/play/p/kHzc8P2kcji">https://go.dev/play/p/kHzc8P2kcji</a></p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>go<span class="w"> </span>run<span class="w"> </span>src/15/channels/done-pattern/main.go
</code></pre></div>
<p>kod:</p>
<div class="highlight"><pre><span></span><code><span class="kn">package</span><span class="w"> </span><span class="nx">main</span>

<span class="kn">import</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="s">&quot;crypto/rand&quot;</span>
<span class="w">    </span><span class="s">&quot;fmt&quot;</span>
<span class="w">    </span><span class="s">&quot;math/big&quot;</span>
<span class="p">)</span>

<span class="kd">func</span><span class="w"> </span><span class="nx">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">amount</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="mi">10</span>

<span class="w">    </span><span class="nx">fmt</span><span class="p">.</span><span class="nx">Println</span><span class="p">(</span><span class="s">&quot;channel&#39;a&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">amount</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;adet sayı yollayacağız&quot;</span><span class="p">)</span>

<span class="w">    </span><span class="nx">ch</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nb">make</span><span class="p">(</span><span class="kd">chan</span><span class="w"> </span><span class="kt">int</span><span class="p">)</span>
<span class="w">    </span><span class="nx">done</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nb">make</span><span class="p">(</span><span class="kd">chan</span><span class="w"> </span><span class="kd">struct</span><span class="p">{})</span>

<span class="w">    </span><span class="c1">// channel&#39;a gönder (send)</span>
<span class="w">    </span><span class="k">go</span><span class="w"> </span><span class="kd">func</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="p">&lt;</span><span class="w"> </span><span class="nx">amount</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="o">++</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nx">randomInt</span><span class="p">,</span><span class="w"> </span><span class="nx">_</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">rand</span><span class="p">.</span><span class="nx">Int</span><span class="p">(</span><span class="nx">rand</span><span class="p">.</span><span class="nx">Reader</span><span class="p">,</span><span class="w"> </span><span class="nx">big</span><span class="p">.</span><span class="nx">NewInt</span><span class="p">(</span><span class="mi">100</span><span class="p">))</span>
<span class="w">            </span><span class="nx">ch</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nb">int</span><span class="p">(</span><span class="nx">randomInt</span><span class="p">.</span><span class="nx">Int64</span><span class="p">())</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="c1">// randon sayı 0-100 araası</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}()</span>

<span class="w">    </span><span class="c1">// channel&#39;dan al (receive)</span>
<span class="w">    </span><span class="k">go</span><span class="w"> </span><span class="kd">func</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">fmt</span><span class="p">.</span><span class="nx">Println</span><span class="p">()</span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="p">&lt;</span><span class="w"> </span><span class="nx">amount</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="o">++</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nx">fmt</span><span class="p">.</span><span class="nx">Println</span><span class="p">(</span><span class="s">&quot;gelen (received) sayı&quot;</span><span class="p">,</span><span class="w"> </span><span class="o">&lt;-</span><span class="nx">ch</span><span class="p">)</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="nx">fmt</span><span class="p">.</span><span class="nx">Println</span><span class="p">()</span>
<span class="w">        </span><span class="nb">close</span><span class="p">(</span><span class="nx">ch</span><span class="p">)</span>

<span class="w">        </span><span class="nb">close</span><span class="p">(</span><span class="nx">done</span><span class="p">)</span><span class="w"> </span><span class="c1">// channel&#39;ı kapat ya da</span>
<span class="w">        </span><span class="c1">// done &lt;- struct{}{} // done için kullanılan channel&#39;a boş struct koy, channel&#39;a veri gitti</span>
<span class="w">    </span><span class="p">}()</span>

<span class="w">    </span><span class="o">&lt;-</span><span class="nx">done</span><span class="w"> </span><span class="c1">// veri gelene kadar blokla...</span>

<span class="w">    </span><span class="nx">fmt</span><span class="p">.</span><span class="nx">Println</span><span class="p">(</span><span class="s">&quot;bitti...&quot;</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div>
<hr />
<h2 id="deadlock">Deadlock</h2>
<p>Channel’a yazan olmazsa, okumak isteyen havada kalır, boşu boşuna bekler. Bu
durumda goroutine’ler uykuya dalar...</p>
<p><strong>fatal error: all goroutines are asleep - deadlock!</strong></p>
<p><a href="https://github.com/vbyazilim/maoyyk2023-golang-101-kursu/tree/main/src/15/channels/done-pattern">Örnek</a></p>
<p><a href="https://go.dev/play/p/U4ulhb8DtVC">https://go.dev/play/p/U4ulhb8DtVC</a></p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>go<span class="w"> </span>run<span class="w"> </span>src/15/channels/deadlock/main.go
</code></pre></div>
<p>kod:</p>
<div class="highlight"><pre><span></span><code><span class="kn">package</span><span class="w"> </span><span class="nx">main</span>

<span class="kn">import</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="s">&quot;fmt&quot;</span>
<span class="w">    </span><span class="s">&quot;time&quot;</span>
<span class="p">)</span>

<span class="kd">func</span><span class="w"> </span><span class="nx">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">ch</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nb">make</span><span class="p">(</span><span class="kd">chan</span><span class="w"> </span><span class="kt">int</span><span class="p">)</span>

<span class="w">    </span><span class="k">go</span><span class="w"> </span><span class="nx">count</span><span class="p">(</span><span class="nx">ch</span><span class="p">)</span>

<span class="w">    </span><span class="c1">// sonsuz döngüde ch channel&#39;ından receive yapıyoruz..</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">fmt</span><span class="p">.</span><span class="nx">Println</span><span class="p">(</span><span class="o">&lt;-</span><span class="nx">ch</span><span class="p">)</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="kd">func</span><span class="w"> </span><span class="nx">count</span><span class="p">(</span><span class="nx">ch</span><span class="w"> </span><span class="kd">chan</span><span class="w"> </span><span class="kt">int</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="p">&lt;</span><span class="w"> </span><span class="mi">5</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="o">++</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">ch</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nx">i</span>
<span class="w">        </span><span class="nx">time</span><span class="p">.</span><span class="nx">Sleep</span><span class="p">(</span><span class="nx">time</span><span class="p">.</span><span class="nx">Millisecond</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">500</span><span class="p">)</span><span class="w"> </span><span class="c1">// yarım saniye bekletme, görmek içim</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="c1">// loop bitti ama yukarıdaki for{} halen okumak istiyor</span>
<span class="p">}</span>

<span class="c1">// 0</span>
<span class="c1">// 1</span>
<span class="c1">// 2</span>
<span class="c1">// 3</span>
<span class="c1">// 4</span>
<span class="c1">// fatal error: all goroutines are asleep - deadlock!</span>
<span class="c1">//</span>
<span class="c1">// goroutine 1 [chan receive]:</span>
<span class="c1">// main.main()</span>
<span class="c1">//  .../src/15/channels/deadlock/main.go:15 +0x7c</span>
<span class="c1">// exit status 2</span>
</code></pre></div>
<p>Neden <strong>deadlock</strong> oluştu? <code>count</code> fonksiyonundaki loop tamamlandı, fonksiyon
işini bitirip çıktı ama biz halen channel’a data gelmesini bekliyoruz <code>main()</code>
içindeki <code>for{}</code>’da.</p>
<p>Artık o channel’a gönderme (send) yapacak aktif bir <strong>goroutine</strong> yok. Bu
bakımdan <code>main()</code> sonsuza kadar bekleyecek ve asla <strong>terminate</strong> olamayacak.
Bu bakımdan go <strong>deadlock</strong> oluşturarak programı durdurdu!</p>
<p>Bu problem <strong>run-time</strong>’da tespit edildi. Yani go bunu <strong>compile-time</strong>’da
değil run-time’da algılayabiliyor. Algılayabilse zaten uyarı verirdi :) Bu
bakımdan kod derlemesi başarılı olsa bile, çalışırken bu tür kötü sürprizler
olabilir.</p>
<p>Bu durum oluştuğu an artık goroutine’ler bir iş yapamıyor, uykuya geçiyor.
Çözüm ne? İş bitiminde kanalı kapatmak.</p>
<h3 id="unutmayin-altin-kural">UNUTMAYIN! ALTIN KURAL</h3>
<p>Eğer siz receiver’sanız (yani kanaldan okuyansanız <code>&lt;-ch</code>) asla channel’ı
kapatmayın, sadece sender (<code>ch &lt;- true</code>) channel’ı kapatmalıdır!</p>
<p>Kanalı kapatacak olan işin bittiğinden emin olan olmalıdır. Sender olan <code>count()</code>
fonksiyonu, loop’un bittiği anı o biliyor. Kapatacak olan da o!</p>
<p>Channel’a yazan (sender) her zaman kaç tane goroutine olduğunu bilir ama
okuyan (receiver) bunu bilemez. <code>close</code> den <strong>her zaman yazan (sender)</strong> olmalıdır!</p>
<p>Aynı örnekte ufak bir değişiklik yapalım:</p>
<p><a href="https://github.com/vbyazilim/maoyyk2023-golang-101-kursu/tree/main/src/15/channels/open-close-check">Örnek</a></p>
<p><a href="https://go.dev/play/p/czqEVQxGg7J">https://go.dev/play/p/czqEVQxGg7J</a></p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>go<span class="w"> </span>run<span class="w"> </span>src/15/channels/open-close-check/main.go
</code></pre></div>
<p>kod:</p>
<div class="highlight"><pre><span></span><code><span class="kn">package</span><span class="w"> </span><span class="nx">main</span>

<span class="kn">import</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="s">&quot;fmt&quot;</span>
<span class="w">    </span><span class="s">&quot;time&quot;</span>
<span class="p">)</span>

<span class="kd">func</span><span class="w"> </span><span class="nx">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">ch</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nb">make</span><span class="p">(</span><span class="kd">chan</span><span class="w"> </span><span class="kt">int</span><span class="p">)</span>

<span class="w">    </span><span class="k">go</span><span class="w"> </span><span class="nx">count</span><span class="p">(</span><span class="nx">ch</span><span class="p">)</span>

<span class="w">    </span><span class="c1">// sonsuz döngüde ch channel&#39;ından receive yapıyoruz..</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="c1">// channel&#39;dan genel golang convention&#39;ındaki gibi</span>
<span class="w">        </span><span class="c1">// value, ok := şeklinde</span>
<span class="w">        </span><span class="c1">// ch&#39;daki değer ve channel&#39;ın açık/kapalı olma bilgisini alıyoruz</span>
<span class="w">        </span><span class="nx">msg</span><span class="p">,</span><span class="w"> </span><span class="nx">open</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="o">&lt;-</span><span class="nx">ch</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">!</span><span class="nx">open</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">break</span><span class="w"> </span><span class="c1">// eğer kapalıysa döngüden çık, main artık exit etsin, iş bitsin</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="nx">fmt</span><span class="p">.</span><span class="nx">Println</span><span class="p">(</span><span class="nx">msg</span><span class="p">)</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="kd">func</span><span class="w"> </span><span class="nx">count</span><span class="p">(</span><span class="nx">ch</span><span class="w"> </span><span class="kd">chan</span><span class="w"> </span><span class="kt">int</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="p">&lt;</span><span class="w"> </span><span class="mi">5</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="o">++</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">ch</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nx">i</span>
<span class="w">        </span><span class="nx">time</span><span class="p">.</span><span class="nx">Sleep</span><span class="p">(</span><span class="nx">time</span><span class="p">.</span><span class="nx">Millisecond</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">500</span><span class="p">)</span><span class="w"> </span><span class="c1">// yarım saniye bekletme, görmek içim</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="nb">close</span><span class="p">(</span><span class="nx">ch</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div>
<p><code>value, ok</code> yaklaşımı ile go bize, eğer channel açıksa (closed değilse)
channel’ın değerini döner. <code>if !open {break}</code> yani channel kapandıysa loop’a
devam etmeye gerek yok.</p>
<p>Keza <strong>send</strong> işlemi de bloklar;</p>
<div class="highlight"><pre><span></span><code><span class="kn">package</span><span class="w"> </span><span class="nx">main</span>

<span class="kn">import</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="s">&quot;fmt&quot;</span>
<span class="p">)</span>

<span class="kd">func</span><span class="w"> </span><span class="nx">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">ch</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nb">make</span><span class="p">(</span><span class="kd">chan</span><span class="w"> </span><span class="kt">string</span><span class="p">)</span>
<span class="w">    </span><span class="nx">ch</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="s">&quot;hello world&quot;</span><span class="w"> </span><span class="c1">// burada bloklar, aynı anda birinin bunu okuması lazım.</span>

<span class="w">    </span><span class="nx">fmt</span><span class="p">.</span><span class="nx">Println</span><span class="p">(</span><span class="o">&lt;-</span><span class="nx">ch</span><span class="p">)</span>
<span class="p">}</span>

<span class="c1">// fatal error: all goroutines are asleep - deadlock!</span>
</code></pre></div>
<p>Çözüm:</p>
<p><a href="https://go.dev/play/p/aZWYNsf7KnW">https://go.dev/play/p/aZWYNsf7KnW</a></p>
<p><a href="https://github.com/vbyazilim/maoyyk2023-golang-101-kursu/tree/main/src/15/unblock-send">Örnek</a></p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>go<span class="w"> </span>run<span class="w"> </span>src/15/channels/unblock-send/main.go
</code></pre></div>
<p>kod:</p>
<div class="highlight"><pre><span></span><code><span class="kn">package</span><span class="w"> </span><span class="nx">main</span>

<span class="kn">import</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="s">&quot;fmt&quot;</span>
<span class="p">)</span>

<span class="kd">func</span><span class="w"> </span><span class="nx">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">ch</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nb">make</span><span class="p">(</span><span class="kd">chan</span><span class="w"> </span><span class="kt">string</span><span class="p">)</span>
<span class="w">    </span><span class="nx">done</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nb">make</span><span class="p">(</span><span class="kd">chan</span><span class="w"> </span><span class="kd">struct</span><span class="p">{})</span>

<span class="w">    </span><span class="c1">// bu kısım main&#39;den farklı bir kulvarda çalışmaya başladı</span>
<span class="w">    </span><span class="k">go</span><span class="w"> </span><span class="kd">func</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">fmt</span><span class="p">.</span><span class="nx">Println</span><span class="p">(</span><span class="o">&lt;-</span><span class="nx">ch</span><span class="p">)</span><span class="w"> </span><span class="c1">// gönder gelsin</span>
<span class="w">        </span><span class="nx">done</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="kd">struct</span><span class="p">{}{}</span>
<span class="w">    </span><span class="p">}()</span>

<span class="w">    </span><span class="nx">ch</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="s">&quot;hello world&quot;</span><span class="w"> </span><span class="c1">// gönderdim</span>
<span class="w">    </span><span class="o">&lt;-</span><span class="nx">done</span>

<span class="w">    </span><span class="nx">fmt</span><span class="p">.</span><span class="nx">Println</span><span class="p">(</span><span class="s">&quot;bitti&quot;</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div>
<p>Ya da <strong>buffered channels</strong> kullanmak</p>
<hr />
<h2 id="range-over-channels">Range Over Channels</h2>
<p>Aynı örneği <strong>syntactic sugar</strong> kullanarak yani, zahmetsiz open/close kontrolü
ve yeteri sayıda iterasyonla channel’ı tüketebiliriz:</p>
<p><a href="https://github.com/vbyazilim/maoyyk2023-golang-101-kursu/tree/main/src/15/channels/range-over-channels">Örnek</a></p>
<p><a href="https://play.golang.org/p/qTwbWZpTSmi">https://play.golang.org/p/qTwbWZpTSmi</a></p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>go<span class="w"> </span>run<span class="w"> </span>src/15/channels/range-over-channels/main.go
</code></pre></div>
<p>kod:</p>
<div class="highlight"><pre><span></span><code><span class="kn">package</span><span class="w"> </span><span class="nx">main</span>

<span class="kn">import</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="s">&quot;fmt&quot;</span>
<span class="w">    </span><span class="s">&quot;time&quot;</span>
<span class="p">)</span>

<span class="kd">func</span><span class="w"> </span><span class="nx">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">ch</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nb">make</span><span class="p">(</span><span class="kd">chan</span><span class="w"> </span><span class="kt">int</span><span class="p">)</span>

<span class="w">    </span><span class="k">go</span><span class="w"> </span><span class="nx">count</span><span class="p">(</span><span class="nx">ch</span><span class="p">)</span>

<span class="w">    </span><span class="c1">// ch channel&#39;ı kapanana kadar içinde iterasyon yapıyoruz</span>
<span class="w">    </span><span class="c1">// bu yöntemle kanal açık mı? kapalı mı? bakmaya gerek kalmıyor...</span>
<span class="w">    </span><span class="c1">// bu bir syntactic sugar</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="nx">msg</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="k">range</span><span class="w"> </span><span class="nx">ch</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">fmt</span><span class="p">.</span><span class="nx">Println</span><span class="p">(</span><span class="nx">msg</span><span class="p">)</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="kd">func</span><span class="w"> </span><span class="nx">count</span><span class="p">(</span><span class="nx">ch</span><span class="w"> </span><span class="kd">chan</span><span class="w"> </span><span class="kt">int</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="p">&lt;</span><span class="w"> </span><span class="mi">5</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="o">++</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">ch</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nx">i</span>
<span class="w">        </span><span class="nx">time</span><span class="p">.</span><span class="nx">Sleep</span><span class="p">(</span><span class="nx">time</span><span class="p">.</span><span class="nx">Millisecond</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">500</span><span class="p">)</span><span class="w"> </span><span class="c1">// yarım saniye bekletme, görmek içim</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="nb">close</span><span class="p">(</span><span class="nx">ch</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div>
<hr />
<h2 id="buffered-channels">Buffered Channels</h2>
<p>Send / receive işleminin asenkron yani birbirlerini beklememeleri için
buffered yani tamponlu channels kullanırız. Bufferın boş olma ya da dolu olma
durumuna göre diğer unbuffered channels’a göre bloklama işlemi farklı çalışır.</p>
<p>Aslında bir tür sender ve receiver arasına <strong>buffer</strong> ekliyoruz:</p>
<p><a href="https://github.com/vbyazilim/maoyyk2023-golang-101-kursu/tree/main/src/15/channels/unblock-send-with-buffered-ch">Örnek</a></p>
<p><a href="https://go.dev/play/p/WRH9PNXlEoK">https://go.dev/play/p/WRH9PNXlEoK</a></p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>go<span class="w"> </span>run<span class="w"> </span>src/15/channels/unblock-send-with-buffered-ch/main.go
</code></pre></div>
<p>kod:</p>
<div class="highlight"><pre><span></span><code><span class="kn">package</span><span class="w"> </span><span class="nx">main</span>

<span class="kn">import</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="s">&quot;fmt&quot;</span>
<span class="p">)</span>

<span class="kd">func</span><span class="w"> </span><span class="nx">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">ch</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nb">make</span><span class="p">(</span><span class="kd">chan</span><span class="w"> </span><span class="kt">string</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="c1">// aynı slice capacity gibi, kapasitesi 1 olan channel</span>
<span class="w">    </span><span class="nx">ch</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="s">&quot;hello world&quot;</span><span class="w">        </span><span class="c1">// gönder, bloklama yok</span>
<span class="w">    </span><span class="nx">fmt</span><span class="p">.</span><span class="nx">Println</span><span class="p">(</span><span class="o">&lt;-</span><span class="nx">ch</span><span class="p">)</span><span class="w">          </span><span class="c1">// anında görüntü</span>

<span class="w">    </span><span class="nx">fmt</span><span class="p">.</span><span class="nx">Println</span><span class="p">(</span><span class="s">&quot;bitti&quot;</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div>
<p>Eğer <code>capacity &gt; 1</code> ise, send/receive garantisi yoktur. Send, receive’den önce
olur. Aslında belirsiz gecikme süresini düşürmek amacıyla kullanılmalıdır.
Buffer küçük olmalı yani <strong>sadece işi yapabilecek kadar</strong> channel kapasitesi
olan bir buffer yapılmalıdır.</p>
<p>Buffer dolduktan sonra o channel’dan okuma yapabiliriz. Buffer <strong>dolana
kadar</strong> bloklama olur. Buffer <strong>sonsuz değildir</strong>! Buffer <strong>dolunca</strong> başka
bir goroutine gidip buffer’dakileri okumalıdır.</p>
<p>Eğer <code>capacity = 1</code> ise, bu <strong>gecikmeli garanti</strong> yani, send, receive’i
garanti edebilir. Receive, send’den önce olur. Sender, <strong>buffer dolana kadar</strong>
blok olmadan gönderir. Buffer dolunca block olur. Receiver, buffer boşalana
kadar blok olmadan receive eder, buffer boşalınca blok olur.</p>
<p>Buffered channel’lar in-memory <strong>FIFO</strong> queue yani, ilk gönderilen (send) ilk
alınan (receive) şeklinde çalışır.</p>
<p><a href="https://github.com/vbyazilim/maoyyk2023-golang-101-kursu/tree/main/src/15/channels/buffered-channels">Örnek</a></p>
<p><a href="https://go.dev/play/p/FrBCaAwfg_l">https://go.dev/play/p/FrBCaAwfg_l</a></p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>go<span class="w"> </span>run<span class="w"> </span>src/15/channels/buffered-channels/main.go
</code></pre></div>
<p>kod:</p>
<div class="highlight"><pre><span></span><code><span class="c1">// nolint:dupword</span>
<span class="kn">package</span><span class="w"> </span><span class="nx">main</span>

<span class="kn">import</span><span class="w"> </span><span class="s">&quot;fmt&quot;</span>

<span class="kd">func</span><span class="w"> </span><span class="nx">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">ch</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nb">make</span><span class="p">(</span><span class="kd">chan</span><span class="w"> </span><span class="kt">int</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">)</span><span class="w">     </span><span class="c1">// Kapasitesi 4 olan buffered bir channel</span>
<span class="w">    </span><span class="nx">done</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nb">make</span><span class="p">(</span><span class="kd">chan</span><span class="w"> </span><span class="kd">struct</span><span class="p">{})</span><span class="w"> </span><span class="c1">// sinyalizasyon için kullanılacak bir channel, buna done channel pattern denir</span>

<span class="w">    </span><span class="c1">// goroutine ateşliyoruz...</span>
<span class="w">    </span><span class="k">go</span><span class="w"> </span><span class="kd">func</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">ch</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="mi">1</span>
<span class="w">        </span><span class="nx">ch</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="mi">2</span>
<span class="w">        </span><span class="nx">ch</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="mi">3</span>
<span class="w">        </span><span class="nx">ch</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="mi">4</span>
<span class="w">        </span><span class="c1">// ch &lt;- 5 // bloklar!</span>
<span class="w">        </span><span class="nb">close</span><span class="p">(</span><span class="nx">ch</span><span class="p">)</span><span class="w"> </span><span class="c1">// channel&#39;ı kapat, artık yazılamaz</span>
<span class="w">    </span><span class="p">}()</span>

<span class="w">    </span><span class="k">go</span><span class="w"> </span><span class="kd">func</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="c1">// buffered channel&#39;dan oku, yöntem 1</span>
<span class="w">        </span><span class="c1">// for i := 0; i &lt; cap(ch); i++ {</span>
<span class="w">        </span><span class="c1">//  fmt.Println(&lt;-ch)</span>
<span class="w">        </span><span class="c1">// }</span>

<span class="w">        </span><span class="c1">// buffered channel&#39;dan oku, yöntem 2</span>
<span class="w">        </span><span class="c1">// fmt.Println(&lt;-ch)</span>
<span class="w">        </span><span class="c1">// fmt.Println(&lt;-ch)</span>
<span class="w">        </span><span class="c1">// fmt.Println(&lt;-ch)</span>
<span class="w">        </span><span class="c1">// fmt.Println(&lt;-ch)</span>
<span class="w">        </span><span class="c1">// fmt.Println(&lt;-ch) chan tipinint zero-value&#39;su yani 0 gelir...</span>
<span class="w">        </span><span class="c1">// buffer 4 idi. biz 5.yi okumak istedik.</span>

<span class="w">        </span><span class="c1">// buffered channel&#39;dan oku, yöntem 3</span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="nx">d</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="k">range</span><span class="w"> </span><span class="nx">ch</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nx">fmt</span><span class="p">.</span><span class="nx">Println</span><span class="p">(</span><span class="nx">d</span><span class="p">)</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="nx">done</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="kd">struct</span><span class="p">{}{}</span>
<span class="w">    </span><span class="p">}()</span>

<span class="w">    </span><span class="o">&lt;-</span><span class="nx">done</span>
<span class="p">}</span>

<span class="c1">// 1</span>
<span class="c1">// 2</span>
<span class="c1">// 3</span>
<span class="c1">// 4</span>
</code></pre></div>
<h2 id="semaphore-pattern">Semaphore Pattern</h2>
<p>Şimdi çık kullanılan <strong>Semaphore Pattern</strong> yaklaşımına bakalım. Örnekte 20
tane goroutine’imiz var, aynı anda maksimum <strong>5 goroutine</strong> kullanmak
istiyoruz.</p>
<p><a href="https://github.com/vbyazilim/maoyyk2023-golang-101-kursu/tree/main/src/15/channels/buffered-semaphore-pattern">Örnek</a></p>
<p><a href="https://go.dev/play/p/u3_rB6lNDe-">https://go.dev/play/p/u3_rB6lNDe-</a></p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>go<span class="w"> </span>run<span class="w"> </span>src/15/channels/buffered-semaphore-pattern/main.go
</code></pre></div>
<p>kod:</p>
<div class="highlight"><pre><span></span><code><span class="kn">package</span><span class="w"> </span><span class="nx">main</span>

<span class="kn">import</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="s">&quot;fmt&quot;</span>
<span class="w">    </span><span class="s">&quot;time&quot;</span>
<span class="p">)</span>

<span class="kd">func</span><span class="w"> </span><span class="nx">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">maxGoroutines</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="mi">20</span><span class="w"> </span><span class="c1">// const maxGoroutines = 20 // olabilirdi</span>
<span class="w">    </span><span class="nx">ch</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nb">make</span><span class="p">(</span><span class="kd">chan</span><span class="w"> </span><span class="kt">int</span><span class="p">,</span><span class="w"> </span><span class="nx">maxGoroutines</span><span class="p">)</span><span class="w"> </span><span class="c1">// 20 kapasitesi olan buffered channel</span>

<span class="w">    </span><span class="nx">maxSemaphore</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="mi">5</span><span class="w"> </span><span class="c1">// const maxSemaphore = 5 // olabilirdi</span>
<span class="w">    </span><span class="nx">sch</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nb">make</span><span class="p">(</span><span class="kd">chan</span><span class="w"> </span><span class="kd">struct</span><span class="p">{},</span><span class="w"> </span><span class="nx">maxSemaphore</span><span class="p">)</span><span class="w"> </span><span class="c1">// semafore channel&#39;ı. kapasitesi 5</span>

<span class="w">    </span><span class="c1">// done := make(chan struct{})</span>

<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="nx">g</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="nx">g</span><span class="w"> </span><span class="p">&lt;</span><span class="w"> </span><span class="nx">maxGoroutines</span><span class="p">;</span><span class="w"> </span><span class="nx">g</span><span class="o">++</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">go</span><span class="w"> </span><span class="kd">func</span><span class="p">(</span><span class="nx">n</span><span class="w"> </span><span class="kt">int</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nx">sch</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="kd">struct</span><span class="p">{}{}</span><span class="w">       </span><span class="c1">// kapasite dolana kadar blok yok (5 slot)</span>
<span class="w">            </span><span class="nx">time</span><span class="p">.</span><span class="nx">Sleep</span><span class="p">(</span><span class="nx">time</span><span class="p">.</span><span class="nx">Second</span><span class="p">)</span><span class="w"> </span><span class="c1">// sadece görüntülemek amacıyla bu goroutine&#39;i beklet</span>

<span class="w">            </span><span class="nx">ch</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nx">n</span><span class="w"> </span><span class="c1">// kapasite dolana kadar blok yok (20 slot)</span>
<span class="w">            </span><span class="o">&lt;-</span><span class="nx">sch</span><span class="w">   </span><span class="c1">// 5 olunca blokla</span>
<span class="w">        </span><span class="p">}(</span><span class="nx">g</span><span class="p">)</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1">// channel&#39;dan okuyoruz, kuyruğu tüketiyoruz...</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="nx">maxGoroutines</span><span class="w"> </span><span class="p">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">fmt</span><span class="p">.</span><span class="nx">Println</span><span class="p">(</span><span class="nx">maxGoroutines</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;ch&quot;</span><span class="p">,</span><span class="w"> </span><span class="o">&lt;-</span><span class="nx">ch</span><span class="p">)</span>
<span class="w">        </span><span class="nx">maxGoroutines</span><span class="o">--</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="nx">fmt</span><span class="p">.</span><span class="nx">Println</span><span class="p">(</span><span class="s">&quot;bitti...&quot;</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div>
<p>Amacımız, <strong>20 tane goroutine’i</strong> aynı anda çalıştırıyoruz ama hepsi aynı anda
çalışmasın diye <strong>semafore</strong> kullanarak aynı anda maksimum <strong>5 tane
goroutine</strong> çalışmasını sağlıyoruz.</p>
<hr />
<h2 id="fan-out-pattern">Fan Out Pattern</h2>
<p><a href="https://github.com/vbyazilim/maoyyk2023-golang-101-kursu/tree/main/src/15/channels/buffered-fan-out-pattern">Örnek</a></p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>go<span class="w"> </span>run<span class="w"> </span>src/15/channels/buffered-fan-out-pattern/main.go
</code></pre></div>
<p>kod:</p>
<div class="highlight"><pre><span></span><code><span class="kn">package</span><span class="w"> </span><span class="nx">main</span>

<span class="kn">import</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="s">&quot;fmt&quot;</span>
<span class="p">)</span>

<span class="kd">func</span><span class="w"> </span><span class="nx">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">maxGoroutines</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="mi">20</span><span class="w"> </span><span class="c1">// 20 goroutine kullanacağız.</span>

<span class="w">    </span><span class="nx">ch</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nb">make</span><span class="p">(</span><span class="kd">chan</span><span class="w"> </span><span class="kt">int</span><span class="p">,</span><span class="w"> </span><span class="nx">maxGoroutines</span><span class="p">)</span><span class="w"> </span><span class="c1">// buffered channel, goroutine sayısı kadar kapasite</span>
<span class="w">    </span><span class="nx">done</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nb">make</span><span class="p">(</span><span class="kd">chan</span><span class="w"> </span><span class="kd">struct</span><span class="p">{})</span><span class="w">         </span><span class="c1">// done channel, sinyalizasyon için</span>

<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="nx">g</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="nx">g</span><span class="w"> </span><span class="p">&lt;</span><span class="w"> </span><span class="nx">maxGoroutines</span><span class="p">;</span><span class="w"> </span><span class="nx">g</span><span class="o">++</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="c1">// nolint her goroutine&#39;nin kendi bufferı var, paralel olarak çalışıyor.</span>
<span class="w">        </span><span class="k">go</span><span class="w"> </span><span class="kd">func</span><span class="p">(</span><span class="nx">n</span><span class="w"> </span><span class="kt">int</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nx">ch</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nx">n</span>
<span class="w">            </span><span class="nx">fmt</span><span class="p">.</span><span class="nx">Println</span><span class="p">(</span><span class="s">&quot;ch &lt;- kanala yolluyoruz (send)&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">n</span><span class="p">)</span>
<span class="w">        </span><span class="p">}(</span><span class="nx">g</span><span class="p">)</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="nb">close</span><span class="p">(</span><span class="nx">done</span><span class="p">)</span>

<span class="w">    </span><span class="c1">// tüketiyoruz, gelenleri alıyoruz.</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="nx">maxGoroutines</span><span class="w"> </span><span class="p">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">fmt</span><span class="p">.</span><span class="nx">Println</span><span class="p">(</span><span class="s">&quot;&lt;- kanaldan alıyoruz (receive)&quot;</span><span class="p">,</span><span class="w"> </span><span class="o">&lt;-</span><span class="nx">ch</span><span class="p">)</span>
<span class="w">        </span><span class="nx">maxGoroutines</span><span class="o">--</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="o">&lt;-</span><span class="nx">done</span>
<span class="p">}</span>
</code></pre></div>
<hr />
<h2 id="select"><code>select</code></h2>
<p>Aynı anda birden fazla channel’ı dinlemek için kullanırız. Daha önce gördüğümüz
<code>switch</code> statement’ına çok benzer.</p>
<p><a href="https://github.com/vbyazilim/maoyyk2023-golang-101-kursu/tree/main/src/15/channels/select">Örnek</a></p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>go<span class="w"> </span>run<span class="w"> </span>src/15/channels/select/main.go
</code></pre></div>
<p>kod:</p>
<div class="highlight"><pre><span></span><code><span class="kn">package</span><span class="w"> </span><span class="nx">main</span>

<span class="kn">import</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="s">&quot;fmt&quot;</span>
<span class="w">    </span><span class="s">&quot;time&quot;</span>
<span class="p">)</span>

<span class="kd">func</span><span class="w"> </span><span class="nx">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">ch1</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nb">make</span><span class="p">(</span><span class="kd">chan</span><span class="w"> </span><span class="kt">string</span><span class="p">)</span>
<span class="w">    </span><span class="nx">ch2</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nb">make</span><span class="p">(</span><span class="kd">chan</span><span class="w"> </span><span class="kt">string</span><span class="p">)</span>

<span class="w">    </span><span class="c1">// goroutine 1</span>
<span class="w">    </span><span class="k">go</span><span class="w"> </span><span class="kd">func</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nx">ch1</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="s">&quot;500ms&quot;</span>
<span class="w">            </span><span class="nx">time</span><span class="p">.</span><span class="nx">Sleep</span><span class="p">(</span><span class="nx">time</span><span class="p">.</span><span class="nx">Millisecond</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">500</span><span class="p">)</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}()</span>

<span class="w">    </span><span class="c1">// goroutine 2</span>
<span class="w">    </span><span class="k">go</span><span class="w"> </span><span class="kd">func</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nx">time</span><span class="p">.</span><span class="nx">Sleep</span><span class="p">(</span><span class="nx">time</span><span class="p">.</span><span class="nx">Second</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span>
<span class="w">            </span><span class="nx">ch2</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="s">&quot;\t2sn&quot;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}()</span>

<span class="w">    </span><span class="c1">// sonsuz döngüde kanalları dinliyoruz.</span>
<span class="w">    </span><span class="c1">// çıkış için ctrl+c</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">select</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">case</span><span class="w"> </span><span class="nx">m1</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="o">&lt;-</span><span class="nx">ch1</span><span class="p">:</span><span class="w"> </span><span class="c1">// ch1&#39;den gelirse</span>
<span class="w">            </span><span class="nx">fmt</span><span class="p">.</span><span class="nx">Println</span><span class="p">(</span><span class="s">&quot;ch1:&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">m1</span><span class="p">)</span>
<span class="w">        </span><span class="k">case</span><span class="w"> </span><span class="nx">m2</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="o">&lt;-</span><span class="nx">ch2</span><span class="p">:</span><span class="w"> </span><span class="c1">// ch2&#39;den gelirse</span>
<span class="w">            </span><span class="nx">fmt</span><span class="p">.</span><span class="nx">Println</span><span class="p">(</span><span class="s">&quot;ch2:&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">m2</span><span class="p">)</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<hr />
<h2 id="ticker">Ticker</h2>
<p><a href="https://github.com/vbyazilim/maoyyk2023-golang-101-kursu/tree/main/src/15/channels/ticker">Örnek</a></p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>go<span class="w"> </span>run<span class="w"> </span>src/15/channels/ticker/main.go
</code></pre></div>
<p>kod:</p>
<div class="highlight"><pre><span></span><code><span class="kn">package</span><span class="w"> </span><span class="nx">main</span>

<span class="kn">import</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="s">&quot;fmt&quot;</span>
<span class="w">    </span><span class="s">&quot;time&quot;</span>
<span class="p">)</span>

<span class="kd">func</span><span class="w"> </span><span class="nx">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">go</span><span class="w"> </span><span class="kd">func</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">heartBeat</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">time</span><span class="p">.</span><span class="nx">Tick</span><span class="p">(</span><span class="mi">1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">time</span><span class="p">.</span><span class="nx">Second</span><span class="p">)</span><span class="w">      </span><span class="c1">// bize channel döner</span>
<span class="w">        </span><span class="nx">otherHeartBeat</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">time</span><span class="p">.</span><span class="nx">Tick</span><span class="p">(</span><span class="mi">5</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">time</span><span class="p">.</span><span class="nx">Second</span><span class="p">)</span><span class="w"> </span><span class="c1">// bize channel döner</span>

<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">select</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">case</span><span class="w"> </span><span class="o">&lt;-</span><span class="nx">heartBeat</span><span class="p">:</span>
<span class="w">                </span><span class="nx">fmt</span><span class="p">.</span><span class="nx">Println</span><span class="p">(</span><span class="s">&quot;-&gt; heartBeat (every second)&quot;</span><span class="p">)</span>
<span class="w">            </span><span class="k">case</span><span class="w"> </span><span class="o">&lt;-</span><span class="nx">otherHeartBeat</span><span class="p">:</span>
<span class="w">                </span><span class="nx">fmt</span><span class="p">.</span><span class="nx">Println</span><span class="p">(</span><span class="s">&quot;-&gt; otherHeartBeat (every 5 seconds)&quot;</span><span class="p">)</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}()</span>

<span class="w">    </span><span class="c1">// sonsuz döngüde &quot;tick&quot;</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">fmt</span><span class="p">.</span><span class="nx">Println</span><span class="p">(</span><span class="s">&quot;tick&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="nx">time</span><span class="p">.</span><span class="nx">Sleep</span><span class="p">(</span><span class="mi">100</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">time</span><span class="p">.</span><span class="nx">Millisecond</span><span class="p">)</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<hr />
<h2 id="worker-pattern">Worker Pattern</h2>
<p><a href="https://github.com/vbyazilim/maoyyk2023-golang-101-kursu/tree/main/src/15/channels/buffered-worker-pattern">Örnek</a></p>
<p><a href="https://go.dev/play/p/zp6kAN83BTP">https://go.dev/play/p/zp6kAN83BTP</a></p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>go<span class="w"> </span>run<span class="w"> </span>src/15/channels/buffered-worker-pattern/main.go<span class="w"> </span>
</code></pre></div>
<p>kod:</p>
<div class="highlight"><pre><span></span><code><span class="kn">package</span><span class="w"> </span><span class="nx">main</span>

<span class="kn">import</span><span class="w"> </span><span class="s">&quot;fmt&quot;</span>

<span class="kd">const</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="nx">workers</span><span class="w">   </span><span class="p">=</span><span class="w"> </span><span class="mi">10</span><span class="w"> </span><span class="c1">// üretenler</span>
<span class="w">    </span><span class="nx">consumers</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">20</span><span class="w"> </span><span class="c1">// tüketenler</span>
<span class="p">)</span>

<span class="kd">func</span><span class="w"> </span><span class="nx">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">jobs</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nb">make</span><span class="p">(</span><span class="kd">chan</span><span class="w"> </span><span class="kt">int</span><span class="p">,</span><span class="w"> </span><span class="mi">100</span><span class="p">)</span>
<span class="w">    </span><span class="nx">results</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nb">make</span><span class="p">(</span><span class="kd">chan</span><span class="w"> </span><span class="kt">int</span><span class="p">,</span><span class="w"> </span><span class="mi">100</span><span class="p">)</span>

<span class="w">    </span><span class="c1">// go worker(jobs, results)</span>

<span class="w">    </span><span class="c1">// go worker(jobs, results)</span>
<span class="w">    </span><span class="c1">// go worker(jobs, results)</span>
<span class="w">    </span><span class="c1">// go worker(jobs, results)</span>

<span class="w">    </span><span class="c1">// 10 tane worker tetikliyoruz</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="p">&lt;</span><span class="w"> </span><span class="nx">workers</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="o">++</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">go</span><span class="w"> </span><span class="nx">worker</span><span class="p">(</span><span class="nx">jobs</span><span class="p">,</span><span class="w"> </span><span class="nx">results</span><span class="p">)</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1">// 100 kapasitesi var buffered channel</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="p">&lt;</span><span class="w"> </span><span class="nb">cap</span><span class="p">(</span><span class="nx">jobs</span><span class="p">);</span><span class="w"> </span><span class="nx">i</span><span class="o">++</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">jobs</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nx">i</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="nb">close</span><span class="p">(</span><span class="nx">jobs</span><span class="p">)</span>

<span class="w">    </span><span class="c1">// 20&#39;li 20&#39;li tüketiyoruz</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="p">&lt;</span><span class="w"> </span><span class="nx">consumers</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="o">++</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">fmt</span><span class="p">.</span><span class="nx">Println</span><span class="p">(</span><span class="o">&lt;-</span><span class="nx">results</span><span class="p">)</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="nb">close</span><span class="p">(</span><span class="nx">results</span><span class="p">)</span>
<span class="p">}</span>

<span class="c1">// jobs: send only channel</span>
<span class="c1">// results: receive only channel</span>
<span class="kd">func</span><span class="w"> </span><span class="nx">worker</span><span class="p">(</span><span class="nx">jobs</span><span class="w"> </span><span class="o">&lt;-</span><span class="kd">chan</span><span class="w"> </span><span class="kt">int</span><span class="p">,</span><span class="w"> </span><span class="nx">results</span><span class="w"> </span><span class="kd">chan</span><span class="o">&lt;-</span><span class="w"> </span><span class="kt">int</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="nx">n</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="k">range</span><span class="w"> </span><span class="nx">jobs</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">results</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nx">task</span><span class="p">(</span><span class="nx">n</span><span class="p">)</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="kd">func</span><span class="w"> </span><span class="nx">task</span><span class="p">(</span><span class="nx">n</span><span class="w"> </span><span class="kt">int</span><span class="p">)</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">pow</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">n</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">n</span>
<span class="w">    </span><span class="nx">fmt</span><span class="p">.</span><span class="nx">Println</span><span class="p">(</span><span class="s">&quot;n=&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">n</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;,n * n=&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">pow</span><span class="p">)</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">pow</span>
<span class="p">}</span>
</code></pre></div>
<hr />
<h2 id="nil-channel"><code>nil</code> Channel</h2>
<div class="highlight"><pre><span></span><code><span class="kn">package</span><span class="w"> </span><span class="nx">main</span>

<span class="kn">import</span><span class="w"> </span><span class="s">&quot;fmt&quot;</span>

<span class="kd">var</span><span class="w"> </span><span class="nx">ch</span><span class="w"> </span><span class="kd">chan</span><span class="w"> </span><span class="kt">bool</span>

<span class="kd">func</span><span class="w"> </span><span class="nx">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">fmt</span><span class="p">.</span><span class="nx">Println</span><span class="p">(</span><span class="nx">ch</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="kc">nil</span><span class="p">)</span><span class="w"> </span><span class="c1">// true</span>

<span class="w">    </span><span class="o">&lt;-</span><span class="nx">ch</span><span class="w"> </span><span class="c1">// fatal error: all goroutines are asleep - deadlock!</span>
<span class="p">}</span>
</code></pre></div>
<hr />
<h2 id="channela-nil-gondermek">Channel’a <code>nil</code> Göndermek</h2>
<p><a href="https://github.com/vbyazilim/maoyyk2023-golang-101-kursu/tree/main/src/15/channels/send-nil">Örnek</a></p>
<p><a href="https://go.dev/play/p/h1A45dC2x3k">https://go.dev/play/p/h1A45dC2x3k</a></p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>go<span class="w"> </span>run<span class="w"> </span>-race<span class="w"> </span>src/15/channels/send-nil/main.go
</code></pre></div>
<p>kod:</p>
<div class="highlight"><pre><span></span><code><span class="kn">package</span><span class="w"> </span><span class="nx">main</span>

<span class="cm">/*</span>
<span class="cm">Package main implements channel merge and demonstrates setting channel to nil</span>

<span class="cm">    https://medium.com/justforfunc/why-are-there-nil-channels-in-go-9877cc0b2308</span>

<span class="cm">    Original code is authored by: Francesc Campoy</span>

<span class="cm">*/</span>

<span class="kn">import</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="s">&quot;crypto/rand&quot;</span>
<span class="w">    </span><span class="s">&quot;fmt&quot;</span>
<span class="w">    </span><span class="s">&quot;math/big&quot;</span>
<span class="w">    </span><span class="s">&quot;time&quot;</span>
<span class="p">)</span>

<span class="kd">func</span><span class="w"> </span><span class="nx">merge</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="w"> </span><span class="nx">b</span><span class="w"> </span><span class="o">&lt;-</span><span class="kd">chan</span><span class="w"> </span><span class="kt">int</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;-</span><span class="kd">chan</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">c</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nb">make</span><span class="p">(</span><span class="kd">chan</span><span class="w"> </span><span class="kt">int</span><span class="p">)</span>
<span class="w">    </span><span class="k">go</span><span class="w"> </span><span class="kd">func</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">defer</span><span class="w"> </span><span class="nb">close</span><span class="p">(</span><span class="nx">c</span><span class="p">)</span>

<span class="w">        </span><span class="c1">// a ya da b channel&#39;ı açık olduğu sürece</span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="nx">a</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">nil</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="nx">b</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">nil</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">select</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">case</span><span class="w"> </span><span class="nx">v</span><span class="p">,</span><span class="w"> </span><span class="nx">ok</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="o">&lt;-</span><span class="nx">a</span><span class="p">:</span>
<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">!</span><span class="nx">ok</span><span class="w"> </span><span class="p">{</span>
<span class="w">                    </span><span class="nx">fmt</span><span class="p">.</span><span class="nx">Println</span><span class="p">(</span><span class="s">&quot;a is done&quot;</span><span class="p">)</span>
<span class="w">                    </span><span class="nx">a</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="kc">nil</span>
<span class="w">                    </span><span class="k">continue</span>
<span class="w">                </span><span class="p">}</span>
<span class="w">                </span><span class="nx">c</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nx">v</span>
<span class="w">            </span><span class="k">case</span><span class="w"> </span><span class="nx">v</span><span class="p">,</span><span class="w"> </span><span class="nx">ok</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="o">&lt;-</span><span class="nx">b</span><span class="p">:</span>
<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">!</span><span class="nx">ok</span><span class="w"> </span><span class="p">{</span>
<span class="w">                    </span><span class="nx">fmt</span><span class="p">.</span><span class="nx">Println</span><span class="p">(</span><span class="s">&quot;b is done&quot;</span><span class="p">)</span>
<span class="w">                    </span><span class="nx">b</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="kc">nil</span>
<span class="w">                    </span><span class="k">continue</span>
<span class="w">                </span><span class="p">}</span>
<span class="w">                </span><span class="nx">c</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nx">v</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}()</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">c</span>
<span class="p">}</span>

<span class="kd">func</span><span class="w"> </span><span class="nx">produceChan</span><span class="p">(</span><span class="nx">vs</span><span class="w"> </span><span class="o">...</span><span class="kt">int</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;-</span><span class="kd">chan</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">c</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nb">make</span><span class="p">(</span><span class="kd">chan</span><span class="w"> </span><span class="kt">int</span><span class="p">)</span>
<span class="w">    </span><span class="k">go</span><span class="w"> </span><span class="kd">func</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="nx">_</span><span class="p">,</span><span class="w"> </span><span class="nx">v</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="k">range</span><span class="w"> </span><span class="nx">vs</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nx">c</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nx">v</span>
<span class="w">            </span><span class="nx">randomInt</span><span class="p">,</span><span class="w"> </span><span class="nx">_</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">rand</span><span class="p">.</span><span class="nx">Int</span><span class="p">(</span><span class="nx">rand</span><span class="p">.</span><span class="nx">Reader</span><span class="p">,</span><span class="w"> </span><span class="nx">big</span><span class="p">.</span><span class="nx">NewInt</span><span class="p">(</span><span class="mi">1000</span><span class="p">))</span>

<span class="w">            </span><span class="c1">// sanki bir işlem oluyormuş gibi...</span>
<span class="w">            </span><span class="nx">time</span><span class="p">.</span><span class="nx">Sleep</span><span class="p">(</span><span class="nx">time</span><span class="p">.</span><span class="nx">Duration</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="nx">randomInt</span><span class="p">.</span><span class="nx">Int64</span><span class="p">())</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">time</span><span class="p">.</span><span class="nx">Millisecond</span><span class="p">)</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="nb">close</span><span class="p">(</span><span class="nx">c</span><span class="p">)</span>
<span class="w">    </span><span class="p">}()</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">c</span>
<span class="p">}</span>

<span class="kd">func</span><span class="w"> </span><span class="nx">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">a</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">produceChan</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="mi">7</span><span class="p">)</span>
<span class="w">    </span><span class="nx">b</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">produceChan</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">6</span><span class="p">,</span><span class="w"> </span><span class="mi">8</span><span class="p">)</span>

<span class="w">    </span><span class="nx">c</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">merge</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="w"> </span><span class="nx">b</span><span class="p">)</span>

<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="nx">v</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="k">range</span><span class="w"> </span><span class="nx">c</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">fmt</span><span class="p">.</span><span class="nx">Println</span><span class="p">(</span><span class="nx">v</span><span class="p">)</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<hr />
<h2 id="drop-pattern">Drop Pattern</h2>
<p><a href="https://github.com/vbyazilim/maoyyk2023-golang-101-kursu/tree/main/src/15/channels/drop-pattern">Örnek</a></p>
<p><a href="https://go.dev/play/p/2fx8kUobwCi">https://go.dev/play/p/2fx8kUobwCi</a></p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>go<span class="w"> </span>run<span class="w"> </span>-race<span class="w"> </span>src/15/channels/drop-pattern/main.go<span class="w"> </span>
</code></pre></div>
<p>kod:</p>
<div class="highlight"><pre><span></span><code><span class="kn">package</span><span class="w"> </span><span class="nx">main</span>

<span class="cm">/*</span>
<span class="cm">Package main implements drop pattern approach</span>

<span class="cm">Amacımız sanki çok yoğun bir ağ ortamında herkes canlı video izliyor.</span>
<span class="cm">Ağdaki yoğunluktan dolayı akışı bozmadan bazı paketleri drop edip hayatın</span>
<span class="cm">devam etmesini sağlıyoruz.</span>
<span class="cm">*/</span>

<span class="kn">import</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="s">&quot;fmt&quot;</span>
<span class="w">    </span><span class="s">&quot;time&quot;</span>
<span class="p">)</span>

<span class="kd">func</span><span class="w"> </span><span class="nx">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">capacity</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="mi">5</span>
<span class="w">    </span><span class="nx">ch</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nb">make</span><span class="p">(</span><span class="kd">chan</span><span class="w"> </span><span class="kt">string</span><span class="p">,</span><span class="w"> </span><span class="nx">capacity</span><span class="p">)</span><span class="w"> </span><span class="c1">// 5 string slotu olan buffered channel</span>

<span class="w">    </span><span class="k">go</span><span class="w"> </span><span class="kd">func</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="c1">// bu goroutine&#39;de receive eden tarafız, channel&#39;a yazılanı (send) buradan</span>
<span class="w">        </span><span class="c1">// okuyoruz</span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="nx">v</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="k">range</span><span class="w"> </span><span class="nx">ch</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nx">fmt</span><span class="p">.</span><span class="nx">Printf</span><span class="p">(</span><span class="s">&quot;(receive): %q\n&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">v</span><span class="p">)</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}()</span>

<span class="w">    </span><span class="nx">packages</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="mi">20</span>
<span class="w">    </span><span class="c1">// küçük bir event-loop simülasyonu yapıyoruz,</span>
<span class="w">    </span><span class="c1">// sanki bir network içindeyiz ve tcp paketlerini okuyoruz</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="nx">p</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="nx">p</span><span class="w"> </span><span class="p">&lt;</span><span class="w"> </span><span class="nx">packages</span><span class="p">;</span><span class="w"> </span><span class="nx">p</span><span class="o">++</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="c1">// 20 paket okur gibi...</span>

<span class="w">        </span><span class="c1">// hem send hem de receive aynı anda olmak üzere</span>
<span class="w">        </span><span class="c1">// select ile çoklu channel işlemleri yapabiliriz</span>
<span class="w">        </span><span class="k">select</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">case</span><span class="w"> </span><span class="nx">ch</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nx">fmt</span><span class="p">.</span><span class="nx">Sprintf</span><span class="p">(</span><span class="s">&quot;paket %d&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">p</span><span class="p">):</span><span class="w"> </span><span class="c1">// channel&#39;a yazıyoruz, buffer dolunca duracak</span>
<span class="w">            </span><span class="nx">fmt</span><span class="p">.</span><span class="nx">Printf</span><span class="p">(</span><span class="s">&quot;(send): paket %d\n&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">p</span><span class="p">)</span>
<span class="w">        </span><span class="k">default</span><span class="p">:</span><span class="w"> </span><span class="c1">// non-blocking, buffer dolunca burası hep çalışacak</span>
<span class="w">            </span><span class="c1">// buffer dolunca bloklamadan devam et</span>
<span class="w">            </span><span class="c1">// bu sayese;</span>
<span class="w">            </span><span class="c1">// network gecikme maaliyetinden kurtulduk</span>
<span class="w">            </span><span class="c1">// channel üzerinde baskı oluşturma maaliyetinden kurtulduk</span>
<span class="w">            </span><span class="c1">// bu iş bir timeout azaltması değil, kapasite azaltmasıdır.</span>
<span class="w">            </span><span class="nx">fmt</span><span class="p">.</span><span class="nx">Printf</span><span class="p">(</span><span class="s">&quot;..(drop): paket %d\n&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">p</span><span class="p">)</span><span class="w"> </span><span class="c1">// buffer dolunca drop!</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="nb">close</span><span class="p">(</span><span class="nx">ch</span><span class="p">)</span><span class="w"> </span><span class="c1">// for p := range ch burasını sonlandırır</span>
<span class="w">    </span><span class="nx">fmt</span><span class="p">.</span><span class="nx">Println</span><span class="p">(</span><span class="s">&quot;bitiyor&quot;</span><span class="p">)</span>

<span class="w">    </span><span class="nx">time</span><span class="p">.</span><span class="nx">Sleep</span><span class="p">(</span><span class="nx">time</span><span class="p">.</span><span class="nx">Second</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div>
<hr />
<h2 id="kaynaklar">Kaynaklar</h2>
<ul>
<li><a href="https://go.dev/blog/pipelines">https://go.dev/blog/pipelines</a></li>
<li><a href="https://talks.golang.org/2012/concurrency.slide#1">https://talks.golang.org/2012/concurrency.slide#1</a></li>
<li><a href="https://go.dev/blog/io2013-talk-concurrency">https://go.dev/blog/io2013-talk-concurrency</a></li>
<li><a href="https://www.ardanlabs.com/blog/2017/10/the-behavior-of-channels.html">https://www.ardanlabs.com/blog/2017/10/the-behavior-of-channels.html</a></li>
<li><a href="https://www.ardanlabs.com/blog/2014/02/the-nature-of-channels-in-go.html">https://www.ardanlabs.com/blog/2014/02/the-nature-of-channels-in-go.html</a></li>
</ul>





                
              </article>
            </div>
          
          
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
            Başa dön
          </button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.indexes", "navigation.top", "toc.integrate"], "search": "../../assets/javascripts/workers/search.dfff1995.min.js", "translations": {"clipboard.copied": "Kopyaland\u0131", "clipboard.copy": "Kopyala", "search.result.more.one": "Bu sayfada 1 tane daha", "search.result.more.other": "Bu sayfada # tane daha", "search.result.none": "E\u015fle\u015fen dok\u00fcman bulunamad\u0131", "search.result.one": "1 dok\u00fcman bulundu", "search.result.other": "# dok\u00fcman bulundu", "search.result.placeholder": "Aramaya ba\u015flamak i\u00e7in yaz\u0131n", "search.result.term.missing": "Eksik", "select.version": "Versiyon se\u00e7"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.dff1b7c8.min.js"></script>
      
    
  </body>
</html>